<div id="cookie-notice" style="display: none; position: fixed; bottom: 0; left: 0; width: 100%; background: #1a1a1a; border-top: 1px solid #333; padding: 1.5rem; z-index: 9999; text-align: center; color: white;">
    <span>{{ i18n "cookie_text" | default "We use anonymous signals to measure network coherence." }}</span>
    <div style="margin-top: 15px;">
        <button id="cookie-notice-accept" style="cursor: pointer; background: #73baf0; color: black; border: none; padding: 8px 20px; font-weight: bold; border-radius: 4px; margin: 0 10px;">{{ i18n "cookie_accept" | default "Accept" }}</button>
        <button id="cookie-notice-deny" style="cursor: pointer; background: transparent; color: #999; border: 1px solid #444; padding: 8px 20px; border-radius: 4px; margin: 0 10px;">{{ i18n "cookie_deny" | default "Deny" }}</button>
    </div>
</div>

<script>
    function readCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for(var i=0;i < ca.length;i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
        }
        return null;
    }

    // Check for existing choice
    var consentChoice = readCookie('cookie-notice-option');
    if (consentChoice === 'true') {
        gtag('consent', 'update', { 'analytics_storage': 'granted', 'ad_storage': 'granted' });
    } else if (consentChoice === null) {
        document.getElementById('cookie-notice').style.display = 'block';
    }

    // Event Listeners for buttons
    document.getElementById('cookie-notice-accept').addEventListener("click", function() {
        document.cookie = "cookie-notice-option=true; max-age=2678400; path=/";
        gtag('consent', 'update', { 'analytics_storage': 'granted', 'ad_storage': 'granted' });
        document.getElementById('cookie-notice').style.display = 'none';
    });

    document.getElementById('cookie-notice-deny').addEventListener("click", function() {
        document.cookie = "cookie-notice-option=false; max-age=2678400; path=/";
        document.getElementById('cookie-notice').style.display = 'none';
    });
</script>